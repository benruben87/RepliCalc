(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     45737,       1416]
NotebookOptionsPosition[     38915,       1294]
NotebookOutlinePosition[     39316,       1310]
CellTagsIndexPosition[     39273,       1307]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["\<\
First, set the working directory to whichever directory you have loaded the \
packages to:\
\>", "Text",
 CellChangeTimes->{{3.909077092581244*^9, 
  3.9090771100675707`*^9}},ExpressionUUID->"33743030-4f14-4f98-a9cd-\
1c2a5754c4c9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetDirectory", "[", "\"\</.../RepliCalcLibraries\>\"", 
  "]"}]], "Input",
 CellChangeTimes->{{3.9090770599461145`*^9, 
  3.9090771120608068`*^9}},ExpressionUUID->"1a7e9eff-bac9-4445-a071-\
0ae01349fcc5"],

Cell[BoxData["\<\"G:\\\\My \
Drive\\\\Pehlevan_Lab\\\\MathemtaicaFiles\\\\BlockRSCLibs\"\>"], "Output",
 CellChangeTimes->{3.909076453495081*^9},
 CellLabel->"Out[34]=",ExpressionUUID->"2fb719a4-07a1-439c-bdcd-07c995dca8b9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"FileNames", "[", "]"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "This", " ", "should", " ", "display", " ", "the", " ", "filenames", " ", 
    "\"\<BlockRSCMatrixOps.m\>\"", " ", "and", " ", 
    "\"\<RSCMatrixOps.m\>\""}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.909076874915411*^9, 3.909076900571062*^9}},
 CellLabel->"In[85]:=",ExpressionUUID->"9c28c78a-b245-4eff-b335-54cf492d7818"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"BlockRSCMatrixOps.m\"\>", ",", "\<\"RSCMatrixOps.m\"\>"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.909076458607281*^9, 3.9090771266114635`*^9},
 CellLabel->"Out[85]=",ExpressionUUID->"fb547fed-4e4e-4c40-bf9e-189ecfc949a4"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{"<<", "RSCMatrixOps.m"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "BlockRSCMatrixOps.m"}], "\[IndentingNewLine]", 
 RowBox[{"On", "[", "Assert", "]"}]}], "Input",
 CellChangeTimes->{{3.895596679956792*^9, 3.895596685233795*^9}, {
  3.89559684648217*^9, 3.8955968521637263`*^9}, {3.8955980651003714`*^9, 
  3.8955980753810663`*^9}, {3.895664334968089*^9, 3.895664343012495*^9}, {
  3.895668198690428*^9, 3.8956681997436223`*^9}, {3.895755289763587*^9, 
  3.8957552984607143`*^9}, {3.8957553653522224`*^9, 3.8957553656670017`*^9}, {
  3.895761709434673*^9, 3.8957617234531283`*^9}, {3.9090764768039365`*^9, 
  3.9090764774192944`*^9}},
 CellLabel->"In[86]:=",ExpressionUUID->"e6135cf3-216f-4501-9c4b-f2a05bb8996e"],

Cell["Define Order parameters:", "Text",
 CellChangeTimes->{{3.9016338990207405`*^9, 3.901633905666165*^9}, {
  3.9016410267331753`*^9, 
  3.901641027493587*^9}},ExpressionUUID->"6840be67-f12f-4e61-8fc1-\
282b1e5fb615"],

Cell["We first define the replica-symmetric order parameters:", "Text",
 CellChangeTimes->{
  3.909076482714115*^9},ExpressionUUID->"3cc3b458-0359-42d8-a4a7-\
75e9459dd9ac"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Q", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"n", ",", "n", ",", 
     RowBox[{"q", "/", "\[Beta]"}], ",", 
     RowBox[{"q0", "/", "\[Beta]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Qhat", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"n", ",", "n", ",", 
     RowBox[{"\[Beta]", "*", "qhat"}], ",", 
     RowBox[{"\[Beta]", "*", "q0hat"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Idn", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"n", ",", " ", "n", ",", " ", "1", ",", " ", "0"}], "}"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"ones", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"n", ",", " ", "1", ",", " ", "0", ",", " ", "1"}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.901633912946669*^9, 3.901633933611627*^9}, {
  3.9016339700117674`*^9, 3.9016339763947906`*^9}, {3.901634007093542*^9, 
  3.901634168265329*^9}, {3.901638727388088*^9, 3.901638765291159*^9}, {
  3.9016430456568537`*^9, 3.9016430565039597`*^9}, {3.9016517055478487`*^9, 
  3.901651745379526*^9}},
 CellLabel->"In[90]:=",ExpressionUUID->"07ce4d21-34f3-4e98-bcc9-0d7445d784f6"],

Cell["Next we construct the free energy and take the limit n->0", "Text",
 CellChangeTimes->{{3.9090764856808667`*^9, 3.9090764869622574`*^9}, {
  3.909077213356013*^9, 
  3.9090772259639044`*^9}},ExpressionUUID->"096a3efb-bdc9-4803-801f-\
0e5606fa1cd3"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"g1", " ", "=", 
   RowBox[{
    RowBox[{"\[Alpha]", "/", 
     RowBox[{"(", "n", ")"}]}], "*", 
    RowBox[{"Log", "[", 
     RowBox[{"RSCdet", "[", 
      RowBox[{"RSCadd", "[", 
       RowBox[{"Idn", ",", " ", 
        RowBox[{"RSCscalarmultiply", "[", 
         RowBox[{
          RowBox[{"\[Beta]", "/", "\[Lambda]"}], ",", " ", "Q"}], "]"}]}], 
       "]"}], "]"}], "]"}]}]}], " ", ";"}], "\n", 
 RowBox[{"g1", " ", "=", " ", 
  RowBox[{"Simplify", "[", 
   RowBox[{"Limit", "[", 
    RowBox[{"g1", ",", " ", 
     RowBox[{"n", "\[Rule]", "0"}]}], "]"}], "]"}]}]}], "Input",
 CellLabel->
  "In[110]:=",ExpressionUUID->"b56fcfe9-c92c-4a70-a62a-41840a111949"],

Cell[BoxData[
 RowBox[{"\[Alpha]", " ", 
  RowBox[{"(", 
   RowBox[{
    FractionBox["q0", 
     RowBox[{"q", "+", "\[Lambda]"}]], "+", 
    RowBox[{"Log", "[", 
     FractionBox[
      RowBox[{"q", "+", "\[Lambda]"}], "\[Lambda]"], "]"}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{3.909076489049054*^9, 3.9090771592658043`*^9, 
  3.909077228044694*^9},
 CellLabel->
  "Out[111]=",ExpressionUUID->"d6a62433-d638-4ede-b571-7628b3f596f1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"g2", " ", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "1"}], "/", 
     RowBox[{"(", "n", ")"}]}], "*", 
    RowBox[{"RSCtrace", "[", 
     RowBox[{"RSCmultiply", "[", 
      RowBox[{"Qhat", ",", " ", "Q"}], "]"}], "]"}]}]}], ";"}], "\n", 
 RowBox[{"g2", " ", "=", " ", 
  RowBox[{"Simplify", "[", 
   RowBox[{"Limit", "[", 
    RowBox[{"g2", ",", " ", 
     RowBox[{"n", "\[Rule]", "0"}]}], "]"}], "]"}]}]}], "Input",
 CellLabel->
  "In[112]:=",ExpressionUUID->"67571bc9-a47d-4b9e-a7b6-f11a67c39422"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "q0"}], " ", "qhat"}], "-", 
  RowBox[{"q", " ", 
   RowBox[{"(", 
    RowBox[{"q0hat", "+", "qhat"}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.909076490658392*^9, 3.909077159794141*^9, 
  3.90907722903475*^9},
 CellLabel->
  "Out[113]=",ExpressionUUID->"10f167a6-18cd-4546-bd32-2db7b53d0424"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"g3", " ", "=", " ", 
  RowBox[{"Simplify", "[", 
   RowBox[{"J", " ", 
    RowBox[{"\[Beta]", "/", "n"}], "*", 
    RowBox[{"RSCtrace", "[", "Q", "]"}]}], "]"}]}]], "Input",
 CellLabel->
  "In[114]:=",ExpressionUUID->"b756dfb6-e65c-4cf0-9841-20ad12a2d575"],

Cell[BoxData[
 RowBox[{"J", " ", 
  RowBox[{"(", 
   RowBox[{"q", "+", "q0"}], ")"}]}]], "Output",
 CellChangeTimes->{3.9090764920316157`*^9, 3.909077165516235*^9, 
  3.909077229940855*^9},
 CellLabel->
  "Out[114]=",ExpressionUUID->"8c78f678-8697-4a94-b044-261790ad0c44"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"temp", " ", "=", " ", 
   RowBox[{"RSCadd", "[", 
    RowBox[{
     RowBox[{"RSCscalarmultiply", "[", 
      RowBox[{"\[Beta]", ",", " ", "Idn"}], "]"}], ",", " ", 
     RowBox[{"RSCscalarmultiply", "[", 
      RowBox[{
       RowBox[{"1", "/", "\[Nu]"}], ",", " ", "Qhat"}], "]"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"g4", " ", "=", " ", 
   RowBox[{"RSCscalarmultiply", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "f"}], "/", 
      RowBox[{"(", 
       RowBox[{"\[Nu]", " ", "n"}], ")"}]}], ",", 
     RowBox[{"RSCmultiplylist", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"RSCtranspose", "[", "ones", "]"}], ",", "Qhat", " ", ",", 
        RowBox[{"RSCinverse", "[", "temp", "]"}], ",", " ", "Qhat", " ", ",", 
        "ones"}], "}"}], "]"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"g4", " ", "=", " ", 
    RowBox[{"g4", "[", 
     RowBox[{"[", "4", "]"}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "Extract", " ", "the", " ", "scalar", " ", "form", " ", "from", " ", "the",
     " ", "1", " ", "by", " ", "1", " ", "matrix"}], "*)"}]}], "\n", 
 RowBox[{"g4", " ", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{"Limit", "[", 
    RowBox[{"g4", ",", 
     RowBox[{"n", "\[Rule]", "0"}]}], "]"}], "]"}]}]}], "Input",
 CellLabel->
  "In[115]:=",ExpressionUUID->"979a93fd-dd8a-47f2-81df-af3ea3d96b73"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"f", " ", 
    SuperscriptBox["qhat", "2"], " ", "\[Beta]"}], 
   RowBox[{"qhat", "+", "\[Nu]"}]]}]], "Output",
 CellChangeTimes->{3.909076493588578*^9, 3.9090771668071623`*^9, 
  3.9090772309820504`*^9},
 CellLabel->
  "Out[118]=",ExpressionUUID->"4eb78947-539e-440d-b62e-3c09c1e5902e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TeXForm", "[", "g4", "]"}]], "Input",
 CellLabel->
  "In[119]:=",ExpressionUUID->"957f59f8-388e-4a78-97cf-62e9ae825909"],

Cell["-\\frac{\\beta  f \\text{qhat}^2}{\\nu +\\text{qhat}}", "Output",
 CellChangeTimes->{3.9090764957126913`*^9, 3.9090771682380686`*^9, 
  3.9090772329388523`*^9},
 CellLabel->
  "Out[119]//TeXForm=",ExpressionUUID->"deae0ceb-6fe5-4c2f-b266-61fcb9e6b69f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"g5", " ", "=", " ", 
   RowBox[{
    RowBox[{"\[Nu]", "/", 
     RowBox[{"(", "n", ")"}]}], 
    RowBox[{"Log", "[", 
     RowBox[{"RSCdet", "[", "temp", "]"}], "]"}]}]}], ";"}], "\n", 
 RowBox[{"g5", " ", "=", " ", 
  RowBox[{"Simplify", "[", 
   RowBox[{"Limit", "[", 
    RowBox[{"g5", ",", " ", 
     RowBox[{"n", "\[Rule]", "0"}]}], "]"}], "]"}]}]}], "Input",
 CellLabel->
  "In[120]:=",ExpressionUUID->"a8d5fd3f-98bd-4a94-ba65-6e8721275140"],

Cell[BoxData[
 RowBox[{"\[Nu]", " ", 
  RowBox[{"(", 
   RowBox[{
    FractionBox["q0hat", 
     RowBox[{"qhat", "+", "\[Nu]"}]], "+", 
    RowBox[{"Log", "[", 
     FractionBox[
      RowBox[{"\[Beta]", " ", 
       RowBox[{"(", 
        RowBox[{"qhat", "+", "\[Nu]"}], ")"}]}], "\[Nu]"], "]"}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{3.9090764995470643`*^9, 3.9090771703026543`*^9, 
  3.9090772341290274`*^9},
 CellLabel->
  "Out[121]=",ExpressionUUID->"d83e5ffe-892d-490c-881e-f7d5cbdfff89"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TeXForm", "[", "g5", "]"}]], "Input",
 CellLabel->
  "In[122]:=",ExpressionUUID->"42ca38ae-20ed-4a5b-adef-669c4cdd5bd8"],

Cell["\<\
\\nu  \\left(\\frac{\\text{q0hat}}{\\nu +\\text{qhat}}+\\log \
\\left(\\frac{\\beta  (\\nu +\\text{qhat})}{\\nu }\\right)\\right)\
\>", "Output",
 CellChangeTimes->{3.909076501461707*^9, 3.9090771713317623`*^9, 
  3.9090772352680573`*^9},
 CellLabel->
  "Out[122]//TeXForm=",ExpressionUUID->"a5907ccf-83f4-4391-b372-08ddd0f8b3dd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"g6", " ", "=", " ", 
   RowBox[{
    RowBox[{"1", "/", "n"}], "*", 
    RowBox[{"RSCsum", "[", "Qhat", "]"}]}]}], ";"}], "\n", 
 RowBox[{"g6", " ", "=", " ", 
  RowBox[{"Simplify", "[", 
   RowBox[{"Limit", "[", 
    RowBox[{"g6", ",", " ", 
     RowBox[{"n", "\[Rule]", "0"}]}], "]"}], "]"}]}]}], "Input",
 CellLabel->
  "In[123]:=",ExpressionUUID->"f0d61179-9bf2-4bdf-b42a-9f7cf3cfd9ea"],

Cell[BoxData[
 RowBox[{"qhat", " ", "\[Beta]"}]], "Output",
 CellChangeTimes->{3.909076504842898*^9, 3.9090771725672054`*^9, 
  3.9090772362711196`*^9},
 CellLabel->
  "Out[124]=",ExpressionUUID->"2862c390-efa8-4b03-b004-bb1f76bda772"]
}, Open  ]],

Cell["We can then write the full free energy in the limit n -> 0", "Text",
 CellChangeTimes->{{3.9090771821481814`*^9, 
  3.909077205660045*^9}},ExpressionUUID->"39ecc117-38b6-4040-8a7e-\
dd12493845cb"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"g", " ", "=", 
  RowBox[{
  "g1", "+", "g2", "+", "g3", "+", "g4", "+", "g5", " ", "+", " ", 
   "g6"}]}]], "Input",
 CellLabel->
  "In[125]:=",ExpressionUUID->"e195e55b-38b6-420a-be76-734f68ec64da"],

Cell[BoxData[
 RowBox[{
  RowBox[{"J", " ", 
   RowBox[{"(", 
    RowBox[{"q", "+", "q0"}], ")"}]}], "-", 
  RowBox[{"q0", " ", "qhat"}], "-", 
  RowBox[{"q", " ", 
   RowBox[{"(", 
    RowBox[{"q0hat", "+", "qhat"}], ")"}]}], "+", 
  RowBox[{"qhat", " ", "\[Beta]"}], "-", 
  FractionBox[
   RowBox[{"f", " ", 
    SuperscriptBox["qhat", "2"], " ", "\[Beta]"}], 
   RowBox[{"qhat", "+", "\[Nu]"}]], "+", 
  RowBox[{"\[Alpha]", " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox["q0", 
      RowBox[{"q", "+", "\[Lambda]"}]], "+", 
     RowBox[{"Log", "[", 
      FractionBox[
       RowBox[{"q", "+", "\[Lambda]"}], "\[Lambda]"], "]"}]}], ")"}]}], "+", 
  RowBox[{"\[Nu]", " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox["q0hat", 
      RowBox[{"qhat", "+", "\[Nu]"}]], "+", 
     RowBox[{"Log", "[", 
      FractionBox[
       RowBox[{"\[Beta]", " ", 
        RowBox[{"(", 
         RowBox[{"qhat", "+", "\[Nu]"}], ")"}]}], "\[Nu]"], "]"}]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{3.909076506576151*^9, 3.9090771748816576`*^9, 
  3.9090772377926083`*^9},
 CellLabel->
  "Out[125]=",ExpressionUUID->"c966aee6-3bde-4eff-be5e-1f71d428ba4b"]
}, Open  ]],

Cell[TextData[{
 "Formally",
 ",",
 " ",
 "we",
 " ",
 "find",
 " ",
 "a",
 " ",
 "formula",
 " ",
 "for",
 " ",
 "the",
 " ",
 "generalization",
 " ",
 "error",
 " ",
 "in",
 " ",
 "terms",
 " ",
 "of",
 " ",
 "the",
 " ",
 "order",
 " ",
 "parameters",
 " ",
 "by",
 " ",
 "differentiating",
 " ",
 "with",
 " ",
 "respect",
 " ",
 "to",
 " ",
 "the",
 " ",
 "source",
 ",",
 " ",
 "which",
 " ",
 "gives",
 " ",
 "us",
 "\n",
 "Eg",
 " ",
 "=",
 " ",
 "q",
 "+",
 "q0",
 ",",
 " ",
 "as",
 " ",
 "wel",
 " ",
 "expected",
 " ",
 "from",
 " ",
 "the",
 " ",
 "form",
 " ",
 "of",
 " ",
 "the",
 " ",
 "order",
 " ",
 "parameter",
 " ",
 StyleBox["Q",
  FontWeight->Bold]
}], "Text",ExpressionUUID->"136942f1-4676-4c43-b5f6-5d211426ac30"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "1"}], "/", "\[Beta]"}], "*", 
  RowBox[{"D", "[", 
   RowBox[{"g", ",", "J"}], "]"}]}]], "Input",
 CellLabel->
  "In[126]:=",ExpressionUUID->"c6ff577a-52c2-4406-a150-18afa888914d"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"q", "+", "q0"}], "\[Beta]"]}]], "Output",
 CellChangeTimes->{3.909076516120304*^9, 3.9090772409581127`*^9},
 CellLabel->
  "Out[126]=",ExpressionUUID->"40b00830-5d03-4132-8934-9878fb7c525f"]
}, Open  ]],

Cell["We obtain saddle-point equations for q and q0:", "Text",ExpressionUUID->"542534d7-1efd-432b-868f-e6ee6e3c9c76"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"gDq0", " ", "=", " ", 
  RowBox[{"Simplify", "[", 
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"g", "/.", 
      RowBox[{"{", 
       RowBox[{"J", "\[Rule]", "0"}], "}"}]}], ",", " ", "q0"}], "]"}], 
   "]"}]}], "\n", 
 RowBox[{"gDq0hat", " ", "=", " ", 
  RowBox[{"Simplify", "[", 
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"g", "/.", 
      RowBox[{"{", 
       RowBox[{"J", "\[Rule]", "0"}], "}"}]}], ",", " ", "q0hat"}], "]"}], 
   "]"}]}]}], "Input",
 CellLabel->
  "In[127]:=",ExpressionUUID->"c219334d-031d-42b1-a798-718ea377149c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "qhat"}], "+", 
  FractionBox["\[Alpha]", 
   RowBox[{"q", "+", "\[Lambda]"}]]}]], "Output",
 CellChangeTimes->{3.9090765240134473`*^9, 3.9090772430472755`*^9},
 CellLabel->
  "Out[127]=",ExpressionUUID->"db4fb359-15a1-4b6e-8826-2c7c6b92edf5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "q"}], "+", 
  FractionBox["\[Nu]", 
   RowBox[{"qhat", "+", "\[Nu]"}]]}]], "Output",
 CellChangeTimes->{3.9090765240134473`*^9, 3.9090772430522623`*^9},
 CellLabel->
  "Out[128]=",ExpressionUUID->"cd097904-87f6-4d37-8570-8ffad588bd46"]
}, Open  ]],

Cell["\<\
Next we solve for the q0.  We expect it to scale linearly with \[Beta], so \
that the error is order 1.\
\>", "Text",
 CellChangeTimes->{{3.9090765310195456`*^9, 
  3.9090765317726016`*^9}},ExpressionUUID->"1c6d7efa-65fb-4f26-b35a-\
d5257c00a796"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"gDq", " ", "=", " ", 
  RowBox[{"Simplify", "[", 
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"g", "/.", 
      RowBox[{"{", 
       RowBox[{"J", "\[Rule]", "0"}], "}"}]}], ",", " ", "q"}], "]"}], 
   "]"}]}], "\n", 
 RowBox[{"gDqhat", " ", "=", " ", 
  RowBox[{"Simplify", "[", 
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"g", "/.", 
      RowBox[{"{", 
       RowBox[{"J", "\[Rule]", "0"}], "}"}]}], ",", " ", "qhat"}], "]"}], 
   "]"}]}], "\n"}], "Input",
 CellLabel->
  "In[129]:=",ExpressionUUID->"4954ad81-59a4-4612-946c-282295268015"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "q0hat"}], "-", "qhat", "+", 
  FractionBox[
   RowBox[{"\[Alpha]", " ", 
    RowBox[{"(", 
     RowBox[{"q", "-", "q0", "+", "\[Lambda]"}], ")"}]}], 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"q", "+", "\[Lambda]"}], ")"}], "2"]]}]], "Output",
 CellChangeTimes->{3.909076533559482*^9, 3.909077244847498*^9},
 CellLabel->
  "Out[129]=",ExpressionUUID->"f9e99b27-13b2-4faa-bd42-125a67241f31"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "q"}], "-", "q0", "+", "\[Beta]", "+", 
  FractionBox[
   RowBox[{"f", " ", 
    SuperscriptBox["qhat", "2"], " ", "\[Beta]"}], 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"qhat", "+", "\[Nu]"}], ")"}], "2"]], "-", 
  FractionBox[
   RowBox[{"2", " ", "f", " ", "qhat", " ", "\[Beta]"}], 
   RowBox[{"qhat", "+", "\[Nu]"}]], "+", 
  FractionBox[
   RowBox[{"\[Nu]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "q0hat"}], "+", "qhat", "+", "\[Nu]"}], ")"}]}], 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"qhat", "+", "\[Nu]"}], ")"}], "2"]]}]], "Output",
 CellChangeTimes->{3.909076533559482*^9, 3.9090772449138355`*^9},
 CellLabel->
  "Out[130]=",ExpressionUUID->"0136b221-9347-4391-990a-4066fef61358"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"q0sols", " ", "=", " ", 
  RowBox[{"Simplify", "[", 
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"gDq", "==", "0"}], ",", " ", 
       RowBox[{"gDqhat", "==", "0"}]}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"q0", ",", " ", "q0hat"}], "}"}]}], "]"}], "]"}]}]], "Input",
 CellLabel->
  "In[131]:=",ExpressionUUID->"ea16cd0d-1119-4257-b73b-bedf3c0488b0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"q0", "\[Rule]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"q", "-", "\[Beta]", "-", 
        FractionBox[
         RowBox[{"f", " ", 
          SuperscriptBox["qhat", "2"], " ", "\[Beta]"}], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"qhat", "+", "\[Nu]"}], ")"}], "2"]], "-", 
        FractionBox[
         RowBox[{"qhat", " ", "\[Nu]"}], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"qhat", "+", "\[Nu]"}], ")"}], "2"]], "-", 
        FractionBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"q", " ", "qhat"}], "-", "\[Alpha]", "+", 
            RowBox[{"qhat", " ", "\[Lambda]"}]}], ")"}], " ", "\[Nu]"}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"q", "+", "\[Lambda]"}], ")"}], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"qhat", "+", "\[Nu]"}], ")"}], "2"]}]], "-", 
        FractionBox[
         SuperscriptBox["\[Nu]", "2"], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"qhat", "+", "\[Nu]"}], ")"}], "2"]], "+", 
        FractionBox[
         RowBox[{"2", " ", "f", " ", "qhat", " ", "\[Beta]"}], 
         RowBox[{"qhat", "+", "\[Nu]"}]]}], 
       RowBox[{"1", "-", 
        FractionBox[
         RowBox[{"\[Alpha]", " ", "\[Nu]"}], 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"q", "+", "\[Lambda]"}], ")"}], "2"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"qhat", "+", "\[Nu]"}], ")"}], "2"]}]]}]]}]}], ",", 
    RowBox[{"q0hat", "\[Rule]", 
     FractionBox[
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["qhat", "3"]}], " ", 
        SuperscriptBox["\[Lambda]", "2"]}], "+", 
       RowBox[{"\[Alpha]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "-", "\[Beta]", "+", "\[Lambda]"}], ")"}], " ", 
        
        SuperscriptBox["\[Nu]", "2"]}], "-", 
       RowBox[{
        SuperscriptBox["q", "2"], " ", "qhat", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"qhat", "+", "\[Nu]"}], ")"}], "2"]}], "+", 
       RowBox[{"2", " ", "q", " ", 
        RowBox[{"(", 
         RowBox[{"\[Alpha]", "-", 
          RowBox[{"qhat", " ", "\[Lambda]"}]}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"qhat", "+", "\[Nu]"}], ")"}], "2"]}], "+", 
       RowBox[{
        SuperscriptBox["qhat", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Alpha]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "f"}], ")"}], " ", "\[Beta]"}], "+", 
             "\[Lambda]"}], ")"}]}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["\[Lambda]", "2"], " ", "\[Nu]"}]}], ")"}]}], "-", 
       RowBox[{"qhat", " ", "\[Nu]", " ", 
        RowBox[{"(", 
         RowBox[{"\[Alpha]", "-", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "f"}], ")"}], " ", "\[Alpha]", " ", 
           "\[Beta]"}], "-", 
          RowBox[{"2", " ", "\[Alpha]", " ", "\[Lambda]"}], "+", 
          RowBox[{
           SuperscriptBox["\[Lambda]", "2"], " ", "\[Nu]"}]}], ")"}]}]}], 
      RowBox[{
       RowBox[{
        SuperscriptBox["qhat", "2"], " ", 
        SuperscriptBox["\[Lambda]", "2"]}], "+", 
       RowBox[{"2", " ", "qhat", " ", 
        SuperscriptBox["\[Lambda]", "2"], " ", "\[Nu]"}], "+", 
       RowBox[{
        SuperscriptBox["q", "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"qhat", "+", "\[Nu]"}], ")"}], "2"]}], "+", 
       RowBox[{"2", " ", "q", " ", "\[Lambda]", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"qhat", "+", "\[Nu]"}], ")"}], "2"]}], "+", 
       RowBox[{"\[Nu]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "\[Alpha]"}], "+", 
          RowBox[{
           SuperscriptBox["\[Lambda]", "2"], " ", "\[Nu]"}]}], ")"}]}]}]]}]}],
    "}"}], "}"}]], "Output",
 CellChangeTimes->{3.9090765373343*^9, 3.909077247207362*^9},
 CellLabel->
  "Out[131]=",ExpressionUUID->"4aee3d92-5183-445c-82fc-9a90f343a936"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"q0expr", " ", "=", " ", 
  RowBox[{"q0sols", "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "1", ",", " ", "2"}], "]"}], "]"}]}]], "Input",
 CellLabel->
  "In[132]:=",ExpressionUUID->"9c34ca0f-5b7f-4bd3-9c8c-9d20be458db5"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"q", "-", "\[Beta]", "-", 
    FractionBox[
     RowBox[{"f", " ", 
      SuperscriptBox["qhat", "2"], " ", "\[Beta]"}], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"qhat", "+", "\[Nu]"}], ")"}], "2"]], "-", 
    FractionBox[
     RowBox[{"qhat", " ", "\[Nu]"}], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"qhat", "+", "\[Nu]"}], ")"}], "2"]], "-", 
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"q", " ", "qhat"}], "-", "\[Alpha]", "+", 
        RowBox[{"qhat", " ", "\[Lambda]"}]}], ")"}], " ", "\[Nu]"}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"q", "+", "\[Lambda]"}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"qhat", "+", "\[Nu]"}], ")"}], "2"]}]], "-", 
    FractionBox[
     SuperscriptBox["\[Nu]", "2"], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"qhat", "+", "\[Nu]"}], ")"}], "2"]], "+", 
    FractionBox[
     RowBox[{"2", " ", "f", " ", "qhat", " ", "\[Beta]"}], 
     RowBox[{"qhat", "+", "\[Nu]"}]]}], 
   RowBox[{"1", "-", 
    FractionBox[
     RowBox[{"\[Alpha]", " ", "\[Nu]"}], 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"q", "+", "\[Lambda]"}], ")"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"qhat", "+", "\[Nu]"}], ")"}], "2"]}]]}]]}]], "Output",
 CellChangeTimes->{3.9090765400327215`*^9, 3.909077248176115*^9},
 CellLabel->
  "Out[132]=",ExpressionUUID->"ed77dc0b-8d6a-4005-b6a1-9cc43f6b9694"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Eg", " ", "=", " ", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Limit", "[", 
      RowBox[{
       RowBox[{"q0expr", "/", "\[Beta]"}], ",", " ", 
       RowBox[{"\[Beta]", "\[Rule]", "Infinity"}]}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{"\[Lambda]", "\[Rule]", 
       RowBox[{
        RowBox[{"\[Alpha]", "/", "qhat"}], "-", "q"}]}], "}"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{"q", "\[Rule]", 
      RowBox[{"\[Nu]", "/", 
       RowBox[{"(", 
        RowBox[{"\[Nu]", "+", "qhat"}], ")"}]}]}], " ", "}"}]}], 
   "]"}]}]], "Input",
 CellLabel->
  "In[133]:=",ExpressionUUID->"b1c5bfdf-0fdd-49cc-a25b-6a0ce06fb5f4"],

Cell[BoxData[
 FractionBox[
  RowBox[{"\[Alpha]", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "f"}], ")"}], " ", 
        SuperscriptBox["qhat", "2"]}], ")"}]}], "-", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "f"}], ")"}], " ", "qhat", " ", "\[Nu]"}], 
     "+", 
     SuperscriptBox["\[Nu]", "2"]}], ")"}]}], 
  RowBox[{
   RowBox[{
    SuperscriptBox["qhat", "2"], " ", 
    RowBox[{"(", 
     RowBox[{"\[Alpha]", "-", "\[Nu]"}], ")"}]}], "+", 
   RowBox[{"2", " ", "qhat", " ", "\[Alpha]", " ", "\[Nu]"}], "+", 
   RowBox[{"\[Alpha]", " ", 
    SuperscriptBox["\[Nu]", "2"]}]}]]], "Output",
 CellChangeTimes->{3.909076548513979*^9, 3.9090772495397863`*^9},
 CellLabel->
  "Out[133]=",ExpressionUUID->"ecb5d2cf-64b4-473d-8fb1-b3c091bb2f50"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TeXForm", "[", "Eg", "]"}]], "Input",
 CellLabel->
  "In[134]:=",ExpressionUUID->"9cc099ef-2677-4598-9d10-e919b4e2ab58"],

Cell["\<\
\\frac{\\alpha  \\left(-\\left((f-1) \\text{qhat}^2\\right)-2 (f-1) \\nu  \
\\text{qhat}+\\nu ^2\\right)}{\\alpha  \\nu ^2+\\text{qhat}^2 (\\alpha -\\nu \
)+2 \\alpha  \\nu 
   \\text{qhat}}\
\>", "Output",
 CellChangeTimes->{3.909076549962902*^9, 3.9090772506616983`*^9},
 CellLabel->
  "Out[134]//TeXForm=",ExpressionUUID->"a7c884dd-6bff-4e9b-a6b3-cd91cba5e34f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"EgS\[Gamma]", " ", "=", " ", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"Eg", "/.", 
     RowBox[{"{", 
      RowBox[{"qhat", " ", "\[Rule]", " ", 
       RowBox[{"\[Nu]", "*", 
        RowBox[{"S", "/", 
         RowBox[{"(", 
          RowBox[{"1", "-", "S"}], ")"}]}]}]}], "}"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{"\[Alpha]", "\[Rule]", 
      RowBox[{"\[Nu]", "*", 
       RowBox[{
        RowBox[{"S", "^", "2"}], "/", "\[Gamma]"}]}]}], "}"}]}], 
   "]"}]}]], "Input",
 CellLabel->"In[78]:=",ExpressionUUID->"3a66ab5f-80f7-4908-be73-a8538b0962b5"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"1", "+", 
    RowBox[{"f", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "2"}], "+", "S"}], ")"}], " ", "S"}]}], 
   RowBox[{
    RowBox[{"-", "1"}], "+", "\[Gamma]"}]]}]], "Output",
 CellChangeTimes->{3.9090765528594065`*^9},
 CellLabel->"Out[78]=",ExpressionUUID->"9a0758a7-c0cc-457b-9f7c-8ee285ee2172"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SPSols", " ", "=", " ", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"gDq0", "==", "0"}], " ", ",", 
      RowBox[{"gDq0hat", "==", "0"}]}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"q", ",", " ", "qhat"}], "}"}]}], "]"}]}]], "Input",
 CellLabel->"In[79]:=",ExpressionUUID->"124a8af6-6693-4824-8ef2-baf82c0ef2d2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"q", "\[Rule]", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "\[Alpha]"}], "+", "\[Nu]", "-", 
        RowBox[{"\[Lambda]", " ", "\[Nu]"}], "-", 
        SqrtBox[
         RowBox[{
          RowBox[{"4", " ", "\[Lambda]", " ", 
           SuperscriptBox["\[Nu]", "2"]}], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"\[Alpha]", "-", "\[Nu]", "+", 
             RowBox[{"\[Lambda]", " ", "\[Nu]"}]}], ")"}], "2"]}]]}], 
       RowBox[{"2", " ", "\[Nu]"}]]}], ",", 
     RowBox[{"qhat", "\[Rule]", 
      FractionBox[
       RowBox[{"\[Alpha]", "-", "\[Nu]", "-", 
        RowBox[{"\[Lambda]", " ", "\[Nu]"}], "-", 
        SqrtBox[
         RowBox[{
          RowBox[{"4", " ", "\[Lambda]", " ", 
           SuperscriptBox["\[Nu]", "2"]}], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"\[Alpha]", "-", "\[Nu]", "+", 
             RowBox[{"\[Lambda]", " ", "\[Nu]"}]}], ")"}], "2"]}]]}], 
       RowBox[{"2", " ", "\[Lambda]"}]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"q", "\[Rule]", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "\[Alpha]"}], "+", "\[Nu]", "-", 
        RowBox[{"\[Lambda]", " ", "\[Nu]"}], "+", 
        SqrtBox[
         RowBox[{
          RowBox[{"4", " ", "\[Lambda]", " ", 
           SuperscriptBox["\[Nu]", "2"]}], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"\[Alpha]", "-", "\[Nu]", "+", 
             RowBox[{"\[Lambda]", " ", "\[Nu]"}]}], ")"}], "2"]}]]}], 
       RowBox[{"2", " ", "\[Nu]"}]]}], ",", 
     RowBox[{"qhat", "\[Rule]", 
      FractionBox[
       RowBox[{"\[Alpha]", "-", "\[Nu]", "-", 
        RowBox[{"\[Lambda]", " ", "\[Nu]"}], "+", 
        SqrtBox[
         RowBox[{
          RowBox[{"4", " ", "\[Lambda]", " ", 
           SuperscriptBox["\[Nu]", "2"]}], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"\[Alpha]", "-", "\[Nu]", "+", 
             RowBox[{"\[Lambda]", " ", "\[Nu]"}]}], ")"}], "2"]}]]}], 
       RowBox[{"2", " ", "\[Lambda]"}]]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.9090765624714317`*^9},
 CellLabel->"Out[79]=",ExpressionUUID->"d6d7cb38-bd0a-487e-a8b3-8de8ba6cbfc0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"qfull", " ", "=", " ", 
  RowBox[{"Normal", "[", 
   RowBox[{"Series", "[", 
    RowBox[{
     RowBox[{"SPSols", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", " ", "1", ",", " ", "2"}], "]"}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"\[Lambda]", ",", " ", "0", ",", " ", "1"}], "}"}]}], "]"}], 
   "]"}]}], "\n", 
 RowBox[{"qhatfull", " ", "=", 
  RowBox[{"\[Alpha]", "/", 
   RowBox[{"(", 
    RowBox[{"\[Lambda]", "+", "qfull"}], ")"}]}]}]}], "Input",
 CellLabel->"In[80]:=",ExpressionUUID->"9963e98c-c6bd-47a4-9ae3-2b1ab53484c1"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    RowBox[{"-", "\[Alpha]"}], "+", 
    SqrtBox[
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"\[Alpha]", "-", "\[Nu]"}], ")"}], "2"]], "+", "\[Nu]"}], 
   RowBox[{"2", " ", "\[Nu]"}]], "+", 
  FractionBox[
   RowBox[{"\[Lambda]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "\[Nu]"}], "+", 
      FractionBox[
       RowBox[{
        RowBox[{"\[Alpha]", " ", "\[Nu]"}], "+", 
        SuperscriptBox["\[Nu]", "2"]}], 
       SqrtBox[
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"\[Alpha]", "-", "\[Nu]"}], ")"}], "2"]]]}], ")"}]}], 
   RowBox[{"2", " ", "\[Nu]"}]]}]], "Output",
 CellChangeTimes->{3.909076568297837*^9},
 CellLabel->"Out[80]=",ExpressionUUID->"70ba5178-9203-48cf-8a3e-187a1442e9a0"],

Cell[BoxData[
 FractionBox["\[Alpha]", 
  RowBox[{"\[Lambda]", "+", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "\[Alpha]"}], "+", 
     SqrtBox[
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"\[Alpha]", "-", "\[Nu]"}], ")"}], "2"]], "+", "\[Nu]"}], 
    RowBox[{"2", " ", "\[Nu]"}]], "+", 
   FractionBox[
    RowBox[{"\[Lambda]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "\[Nu]"}], "+", 
       FractionBox[
        RowBox[{
         RowBox[{"\[Alpha]", " ", "\[Nu]"}], "+", 
         SuperscriptBox["\[Nu]", "2"]}], 
        SqrtBox[
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"\[Alpha]", "-", "\[Nu]"}], ")"}], "2"]]]}], ")"}]}], 
    RowBox[{"2", " ", "\[Nu]"}]]}]]], "Output",
 CellChangeTimes->{3.909076568306814*^9},
 CellLabel->"Out[81]=",ExpressionUUID->"29f767ad-7b63-4b45-937c-2e7604cea77b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Egfull", " ", "=", " ", 
  RowBox[{"Eg", "/.", 
   RowBox[{"{", 
    RowBox[{"qhat", "\[Rule]", "qhatfull"}], "}"}]}]}]], "Input",
 CellLabel->"In[82]:=",ExpressionUUID->"81c42f7d-ccb3-45f8-9160-1aeaf3429ada"],

Cell[BoxData[
 FractionBox[
  RowBox[{"\[Alpha]", " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["\[Nu]", "2"], "-", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "f"}], ")"}], " ", 
       SuperscriptBox["\[Alpha]", "2"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"\[Lambda]", "+", 
         FractionBox[
          RowBox[{
           RowBox[{"-", "\[Alpha]"}], "+", 
           SqrtBox[
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"\[Alpha]", "-", "\[Nu]"}], ")"}], "2"]], "+", 
           "\[Nu]"}], 
          RowBox[{"2", " ", "\[Nu]"}]], "+", 
         FractionBox[
          RowBox[{"\[Lambda]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "\[Nu]"}], "+", 
             FractionBox[
              RowBox[{
               RowBox[{"\[Alpha]", " ", "\[Nu]"}], "+", 
               SuperscriptBox["\[Nu]", "2"]}], 
              SqrtBox[
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"\[Alpha]", "-", "\[Nu]"}], ")"}], "2"]]]}], ")"}]}], 
          RowBox[{"2", " ", "\[Nu]"}]]}], ")"}], "2"]], "-", 
     FractionBox[
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "f"}], ")"}], " ", "\[Alpha]", " ", 
       "\[Nu]"}], 
      RowBox[{"\[Lambda]", "+", 
       FractionBox[
        RowBox[{
         RowBox[{"-", "\[Alpha]"}], "+", 
         SqrtBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"\[Alpha]", "-", "\[Nu]"}], ")"}], "2"]], "+", "\[Nu]"}], 
        
        RowBox[{"2", " ", "\[Nu]"}]], "+", 
       FractionBox[
        RowBox[{"\[Lambda]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "\[Nu]"}], "+", 
           FractionBox[
            RowBox[{
             RowBox[{"\[Alpha]", " ", "\[Nu]"}], "+", 
             SuperscriptBox["\[Nu]", "2"]}], 
            SqrtBox[
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"\[Alpha]", "-", "\[Nu]"}], ")"}], "2"]]]}], ")"}]}], 
        RowBox[{"2", " ", "\[Nu]"}]]}]]}], ")"}]}], 
  RowBox[{
   RowBox[{"\[Alpha]", " ", 
    SuperscriptBox["\[Nu]", "2"]}], "+", 
   FractionBox[
    RowBox[{
     SuperscriptBox["\[Alpha]", "2"], " ", 
     RowBox[{"(", 
      RowBox[{"\[Alpha]", "-", "\[Nu]"}], ")"}]}], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"\[Lambda]", "+", 
       FractionBox[
        RowBox[{
         RowBox[{"-", "\[Alpha]"}], "+", 
         SqrtBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"\[Alpha]", "-", "\[Nu]"}], ")"}], "2"]], "+", "\[Nu]"}], 
        
        RowBox[{"2", " ", "\[Nu]"}]], "+", 
       FractionBox[
        RowBox[{"\[Lambda]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "\[Nu]"}], "+", 
           FractionBox[
            RowBox[{
             RowBox[{"\[Alpha]", " ", "\[Nu]"}], "+", 
             SuperscriptBox["\[Nu]", "2"]}], 
            SqrtBox[
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"\[Alpha]", "-", "\[Nu]"}], ")"}], "2"]]]}], ")"}]}], 
        RowBox[{"2", " ", "\[Nu]"}]]}], ")"}], "2"]], "+", 
   FractionBox[
    RowBox[{"2", " ", 
     SuperscriptBox["\[Alpha]", "2"], " ", "\[Nu]"}], 
    RowBox[{"\[Lambda]", "+", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "\[Alpha]"}], "+", 
       SqrtBox[
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"\[Alpha]", "-", "\[Nu]"}], ")"}], "2"]], "+", "\[Nu]"}], 
      RowBox[{"2", " ", "\[Nu]"}]], "+", 
     FractionBox[
      RowBox[{"\[Lambda]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "\[Nu]"}], "+", 
         FractionBox[
          RowBox[{
           RowBox[{"\[Alpha]", " ", "\[Nu]"}], "+", 
           SuperscriptBox["\[Nu]", "2"]}], 
          SqrtBox[
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"\[Alpha]", "-", "\[Nu]"}], ")"}], "2"]]]}], ")"}]}], 
      RowBox[{"2", " ", "\[Nu]"}]]}]]}]]], "Output",
 CellChangeTimes->{3.909076586390545*^9},
 CellLabel->"Out[82]=",ExpressionUUID->"784259ef-5650-4ca3-85fe-8b7b8790f48f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"Limit", "[", 
    RowBox[{"Egfull", ",", " ", 
     RowBox[{"\[Lambda]", "\[Rule]", "0"}]}], "]"}], ",", " ", 
   RowBox[{"Assumptions", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\[Alpha]", "<", "\[Nu]"}], "}"}]}]}], "]"}]], "Input",
 CellLabel->"In[83]:=",ExpressionUUID->"203b689c-a62c-4e8b-b75b-8c7a52a126d7"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"f", " ", "\[Alpha]", " ", 
    RowBox[{"(", 
     RowBox[{"\[Alpha]", "-", 
      RowBox[{"2", " ", "\[Nu]"}]}], ")"}]}], "+", 
   SuperscriptBox["\[Nu]", "2"]}], 
  RowBox[{"\[Nu]", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "\[Alpha]"}], "+", "\[Nu]"}], ")"}]}]]], "Output",
 CellChangeTimes->{3.909076588452513*^9},
 CellLabel->"Out[83]=",ExpressionUUID->"5f1e5a0c-6850-46f1-9e27-c09330e861d4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"Limit", "[", 
    RowBox[{"Egfull", ",", " ", 
     RowBox[{"\[Lambda]", "\[Rule]", "0"}]}], "]"}], ",", " ", 
   RowBox[{"Assumptions", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\[Alpha]", ">", "\[Nu]"}], "}"}]}]}], "]"}]], "Input",
 CellLabel->"In[84]:=",ExpressionUUID->"4e6198ee-fb21-4b4f-9edb-2a0b4660a2b6"],

Cell[BoxData[
 FractionBox[
  RowBox[{"\[Alpha]", "-", 
   RowBox[{"f", " ", "\[Alpha]"}]}], 
  RowBox[{"\[Alpha]", "-", "\[Nu]"}]]], "Output",
 CellChangeTimes->{3.9090765894331365`*^9},
 CellLabel->"Out[84]=",ExpressionUUID->"84e0a38c-4602-4397-85f6-3156bdbb079b"]
}, Open  ]]
},
WindowSize->{1236, 735},
WindowMargins->{{Automatic, 48.75}, {Automatic, 0}},
FrontEndVersion->"13.1 for Microsoft Windows (64-bit) (June 16, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"81cb9b35-4c0b-4e8f-bcbc-219ec2494dc7"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 242, 6, 35, "Text",ExpressionUUID->"33743030-4f14-4f98-a9cd-1c2a5754c4c9"],
Cell[CellGroupData[{
Cell[825, 30, 228, 5, 28, "Input",ExpressionUUID->"1a7e9eff-bac9-4445-a071-0ae01349fcc5"],
Cell[1056, 37, 224, 3, 32, "Output",ExpressionUUID->"2fb719a4-07a1-439c-bdcd-07c995dca8b9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1317, 45, 421, 9, 28, "Input",ExpressionUUID->"9c28c78a-b245-4eff-b335-54cf492d7818"],
Cell[1741, 56, 268, 5, 32, "Output",ExpressionUUID->"fb547fed-4e4e-4c40-bf9e-189ecfc949a4"]
}, Open  ]],
Cell[2024, 64, 735, 11, 67, "Input",ExpressionUUID->"e6135cf3-216f-4501-9c4b-f2a05bb8996e"],
Cell[2762, 77, 219, 4, 35, "Text",ExpressionUUID->"6840be67-f12f-4e61-8fc1-282b1e5fb615"],
Cell[2984, 83, 173, 3, 35, "Text",ExpressionUUID->"3cc3b458-0359-42d8-a4a7-75e9459dd9ac"],
Cell[3160, 88, 1135, 29, 86, "Input",ExpressionUUID->"07ce4d21-34f3-4e98-bcc9-0d7445d784f6"],
Cell[4298, 119, 254, 4, 35, "Text",ExpressionUUID->"096a3efb-bdc9-4803-801f-0e5606fa1cd3"],
Cell[CellGroupData[{
Cell[4577, 127, 698, 20, 48, "Input",ExpressionUUID->"b56fcfe9-c92c-4a70-a62a-41840a111949"],
Cell[5278, 149, 439, 13, 51, "Output",ExpressionUUID->"d6a62433-d638-4ede-b571-7628b3f596f1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5754, 167, 542, 16, 48, "Input",ExpressionUUID->"67571bc9-a47d-4b9e-a7b6-f11a67c39422"],
Cell[6299, 185, 346, 10, 32, "Output",ExpressionUUID->"10f167a6-18cd-4546-bd32-2db7b53d0424"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6682, 200, 280, 7, 28, "Input",ExpressionUUID->"b756dfb6-e65c-4cf0-9841-20ad12a2d575"],
Cell[6965, 209, 272, 7, 32, "Output",ExpressionUUID->"8c78f678-8697-4a94-b044-261790ad0c44"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7274, 221, 1402, 40, 86, "Input",ExpressionUUID->"979a93fd-dd8a-47f2-81df-af3ea3d96b73"],
Cell[8679, 263, 342, 9, 53, "Output",ExpressionUUID->"4eb78947-539e-440d-b62e-3c09c1e5902e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9058, 277, 144, 3, 28, "Input",ExpressionUUID->"957f59f8-388e-4a78-97cf-62e9ae825909"],
Cell[9205, 282, 258, 4, 47, "Output",ExpressionUUID->"deae0ceb-6fe5-4c2f-b266-61fcb9e6b69f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9500, 291, 483, 14, 48, "Input",ExpressionUUID->"a8d5fd3f-98bd-4a94-ba65-6e8721275140"],
Cell[9986, 307, 500, 15, 51, "Output",ExpressionUUID->"d83e5ffe-892d-490c-881e-f7d5cbdfff89"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10523, 327, 144, 3, 28, "Input",ExpressionUUID->"42ca38ae-20ed-4a5b-adef-669c4cdd5bd8"],
Cell[10670, 332, 340, 7, 47, "Output",ExpressionUUID->"a5907ccf-83f4-4391-b372-08ddd0f8b3dd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11047, 344, 425, 12, 48, "Input",ExpressionUUID->"f0d61179-9bf2-4bdf-b42a-9f7cf3cfd9ea"],
Cell[11475, 358, 235, 5, 32, "Output",ExpressionUUID->"2862c390-efa8-4b03-b004-bb1f76bda772"]
}, Open  ]],
Cell[11725, 366, 202, 3, 35, "Text",ExpressionUUID->"39ecc117-38b6-4040-8a7e-dd12493845cb"],
Cell[CellGroupData[{
Cell[11952, 373, 223, 6, 28, "Input",ExpressionUUID->"e195e55b-38b6-420a-be76-734f68ec64da"],
Cell[12178, 381, 1154, 36, 53, "Output",ExpressionUUID->"c966aee6-3bde-4eff-be5e-1f71d428ba4b"]
}, Open  ]],
Cell[13347, 420, 739, 84, 58, "Text",ExpressionUUID->"136942f1-4676-4c43-b5f6-5d211426ac30"],
Cell[CellGroupData[{
Cell[14111, 508, 232, 7, 28, "Input",ExpressionUUID->"c6ff577a-52c2-4406-a150-18afa888914d"],
Cell[14346, 517, 246, 6, 50, "Output",ExpressionUUID->"40b00830-5d03-4132-8934-9878fb7c525f"]
}, Open  ]],
Cell[14607, 526, 117, 0, 35, "Text",ExpressionUUID->"542534d7-1efd-432b-868f-e6ee6e3c9c76"],
Cell[CellGroupData[{
Cell[14749, 530, 573, 18, 48, "Input",ExpressionUUID->"c219334d-031d-42b1-a798-718ea377149c"],
Cell[15325, 550, 282, 7, 48, "Output",ExpressionUUID->"db4fb359-15a1-4b6e-8826-2c7c6b92edf5"],
Cell[15610, 559, 275, 7, 48, "Output",ExpressionUUID->"cd097904-87f6-4d37-8570-8ffad588bd46"]
}, Open  ]],
Cell[15900, 569, 257, 6, 35, "Text",ExpressionUUID->"1c6d7efa-65fb-4f26-b35a-d5257c00a796"],
Cell[CellGroupData[{
Cell[16182, 579, 575, 18, 67, "Input",ExpressionUUID->"4954ad81-59a4-4612-946c-282295268015"],
Cell[16760, 599, 438, 12, 52, "Output",ExpressionUUID->"f9e99b27-13b2-4faa-bd42-125a67241f31"],
Cell[17201, 613, 768, 22, 54, "Output",ExpressionUUID->"0136b221-9347-4391-990a-4066fef61358"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18006, 640, 431, 12, 28, "Input",ExpressionUUID->"ea16cd0d-1119-4257-b73b-bedf3c0488b0"],
Cell[18440, 654, 4365, 123, 125, "Output",ExpressionUUID->"4aee3d92-5183-445c-82fc-9a90f343a936"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22842, 782, 244, 6, 28, "Input",ExpressionUUID->"9c34ca0f-5b7f-4bd3-9c8c-9d20be458db5"],
Cell[23089, 790, 1552, 47, 73, "Output",ExpressionUUID->"ed77dc0b-8d6a-4005-b6a1-9cc43f6b9694"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24678, 842, 677, 20, 28, "Input",ExpressionUUID->"b1c5bfdf-0fdd-49cc-a25b-6a0ce06fb5f4"],
Cell[25358, 864, 916, 28, 56, "Output",ExpressionUUID->"ecb5d2cf-64b4-473d-8fb1-b3c091bb2f50"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26311, 897, 144, 3, 28, "Input",ExpressionUUID->"9cc099ef-2677-4598-9d10-e919b4e2ab58"],
Cell[26458, 902, 374, 8, 64, "Output",ExpressionUUID->"a7c884dd-6bff-4e9b-a6b3-cd91cba5e34f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26869, 915, 592, 17, 28, "Input",ExpressionUUID->"3a66ab5f-80f7-4908-be73-a8538b0962b5"],
Cell[27464, 934, 375, 11, 50, "Output",ExpressionUUID->"9a0758a7-c0cc-457b-9f7c-8ee285ee2172"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27876, 950, 384, 10, 28, "Input",ExpressionUUID->"124a8af6-6693-4824-8ef2-baf82c0ef2d2"],
Cell[28263, 962, 2304, 62, 96, "Output",ExpressionUUID->"d6d7cb38-bd0a-487e-a8b3-8de8ba6cbfc0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[30604, 1029, 573, 15, 48, "Input",ExpressionUUID->"9963e98c-c6bd-47a4-9ae3-2b1ab53484c1"],
Cell[31180, 1046, 796, 25, 64, "Output",ExpressionUUID->"70ba5178-9203-48cf-8a3e-187a1442e9a0"],
Cell[31979, 1073, 864, 26, 76, "Output",ExpressionUUID->"29f767ad-7b63-4b45-937c-2e7604cea77b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32880, 1104, 233, 5, 28, "Input",ExpressionUUID->"81c42f7d-ccb3-45f8-9160-1aeaf3429ada"],
Cell[33116, 1111, 4222, 129, 226, "Output",ExpressionUUID->"784259ef-5650-4ca3-85fe-8b7b8790f48f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[37375, 1245, 378, 9, 28, "Input",ExpressionUUID->"203b689c-a62c-4e8b-b75b-8c7a52a126d7"],
Cell[37756, 1256, 459, 13, 53, "Output",ExpressionUUID->"5f1e5a0c-6850-46f1-9e27-c09330e861d4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38252, 1274, 378, 9, 28, "Input",ExpressionUUID->"4e6198ee-fb21-4b4f-9edb-2a0b4660a2b6"],
Cell[38633, 1285, 266, 6, 49, "Output",ExpressionUUID->"84e0a38c-4602-4397-85f6-3156bdbb079b"]
}, Open  ]]
}
]
*)

